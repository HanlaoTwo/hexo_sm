<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>你才是程序员</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一个码畜的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="你才是程序员">
<meta property="og:url" content="http://hanlaotwo.com/page/13/index.html">
<meta property="og:site_name" content="你才是程序员">
<meta property="og:description" content="一个码畜的博客">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="你才是程序员">
<meta name="twitter:description" content="一个码畜的博客">
  
    <link rel="alternate" href="/blog/atom.xml" title="你才是程序员" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">你才是程序员</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">no bb show your code</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://hanlaotwo.com"></form>
      </div>
    </div>
  </div>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1560148445627079",
    enable_page_level_ads: true
  });
</script>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-python/work" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/work/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/work/">work</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>`</code></p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding:utf-8 --"></a>-<em>- coding:utf-8 -</em>-</h1><p>import requests<br>import re<br>import random</p>
<p>header_login = {<br>    ‘Host’: ‘hs-cas.hundsun.com’,<br>    ‘User-Agent’: ‘Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36’,<br>    ‘Upgrade-Insecure-Requests’: ‘1’,<br>    ‘Accept’: ‘text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8’,<br>    ‘Accept-Language’: ‘en-US,en;q=0.5’,<br>    ‘Accept-Encoding’: ‘gzip, deflate, sdch’,<br>    ‘Connection’: ‘keep-alive’,<br>    ‘Cache-Control’: ‘max-age=0’<br>}</p>
<p>header_info = {<br>    ‘User-Agent’: ‘Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36’,<br>    ‘Upgrade-Insecure-Requests’: ‘1’,<br>    ‘Accept’: ‘text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8’,<br>    ‘Accept-Language’: ‘en-US,en;q=0.5’,<br>    ‘Accept-Encoding’: ‘gzip, deflate, sdch’,<br>    ‘Referer’: ‘127.0.0.1:8888’,<br>    ‘Connection’: ‘keep-alive’,<br>    ‘Cache-Control’: ‘max-age=0’<br>}</p>
<p>login_url = ‘<a href="https://hs-cas.hundsun.com/cas/login?service=http%3A%2F%2Fpm.hundsun.com%3A80%2Fj_acegi_cas_security_check&#39;" target="_blank" rel="noopener">https://hs-cas.hundsun.com/cas/login?service=http%3A%2F%2Fpm.hundsun.com%3A80%2Fj_acegi_cas_security_check&#39;</a><br>s = requests.Session()</p>
<h1 id="html-s-get-login-url-headers-header"><a href="#html-s-get-login-url-headers-header" class="headerlink" title="html = s.get(login_url, headers=header)"></a>html = s.get(login_url, headers=header)</h1><p>html = s.get(login_url, headers=header_login, verify=False)</p>
<h1 id="print-html"><a href="#print-html" class="headerlink" title="print(html)"></a>print(html)</h1><p>print(‘结果：’, html.status_code)<br>print(‘原因：’, html.reason)</p>
<p>rule1 = ‘<input type="\"hidden\"" name="\"lt\"" value="\"(.*?)\"" \="">‘<br>rule2 = ‘<input type="hidden" name="execution" value="(.*?)" \="">‘<br>rule3 = ‘<input type="\"hidden\"" name="\"_eventId\"" value="\"(.*?)\"" \="">‘</p>
<p>patten1 = re.compile(rule1, re.S)<br>patten2 = re.compile(rule2, re.S)<br>patten3 = re.compile(rule3, re.S)</p>
<p>array1 = re.findall(patten1, html.text)<br>array2 = re.findall(patten2, html.text)<br>array3 = re.findall(patten3, html.text)<br>loginParams = {<br>    ‘username’: ‘hanqian18790’,<br>    ‘password’: ‘hanQIAN1993’,<br>    ‘lt’: array1[0],<br>    ‘execution’: array2[0],<br>    ‘_eventId’: array3[0]<br>}<br>sessionHtml = s.post(login_url, data=loginParams, verify=False)</p>
<p>print(“the session rsult is: “, sessionHtml.status_code)<br>print(“the reason is: “, sessionHtml.reason)</p>
<p>indexhtml = s.get(‘<a href="http://pm.hundsun.com/main.do&#39;" target="_blank" rel="noopener">http://pm.hundsun.com/main.do&#39;</a>, headers=header_login, verify=False)</p>
<p>r = random.random()<br>content = s.get(<br>    ‘<a href="http://pm.hundsun.com/pages/task/entityTab.jsf?taskId=423c943d-85d7-4cf8-9ce0-7020ad064bc4&amp;action=0&amp;keepOperate=N&amp;r=&#39;+str(r)" target="_blank" rel="noopener">http://pm.hundsun.com/pages/task/entityTab.jsf?taskId=423c943d-85d7-4cf8-9ce0-7020ad064bc4&amp;action=0&amp;keepOperate=N&amp;r=&#39;+str(r)</a><br>    , headers=header_info, verify=False)<br>print(‘——-&gt;’, content.status_code)<br>print(‘——-&gt;’, content.text)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/work/" data-id="cjjedmhbl00710gtjue70gx01" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python/安装cx_Oracle报错：unable to find vcvarsall.bat" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/安装cx_Oracle报错：unable to find vcvarsall.bat/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/安装cx_Oracle报错：unable to find vcvarsall.bat/">安装cx_Oracle报错：unable to find vcvarsall.bat</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="环境："><a href="#环境：" class="headerlink" title="环境："></a>环境：</h4><blockquote>
<p>Python3.5</p>
<p>vs 2008</p>
</blockquote>
<h4 id="报错："><a href="#报错：" class="headerlink" title="报错："></a>报错：</h4><blockquote>
<p>unable to find vcvarsall.bat</p>
</blockquote>
<h4 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h4><p><em>python的distutils模块中的msvc9compiler.py并不从环境变量指定的路径中寻找’vcvarsall.bat’，而是通过注册表来寻找…，然而，不知为什么编译器安装过程没有配置注册表。</em></p>
<h4 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h4><p>网上有很多，但是都不能很快解决。</p>
<h2 id="终极牛逼方案：安装最新版"><a href="#终极牛逼方案：安装最新版" class="headerlink" title="终极牛逼方案：安装最新版"></a><strong>终极牛逼方案：<em>安装最新版</em></strong></h2><blockquote>
<p>python -m pip install cx_Oracle –pre</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/安装cx_Oracle报错：unable to find vcvarsall.bat/" data-id="cjjedmhbm00730gtjmi1ure19" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python/安装python3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/安装python3/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/安装python3/">安装python3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>wget <a href="https://www.python.org/ftp/python/3.6.3/Python-3.6.3.tgz" target="_blank" rel="noopener">https://www.python.org/ftp/python/3.6.3/Python-3.6.3.tgz</a></p>
<p> tar -zxvf Python-3.6.3.tgz</p>
<p> yum install gcc</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> Installed:</span><br><span class="line">  gcc.x86_64 0:4.8.5-16.el7                                                                                                                                                                                       </span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  cpp.x86_64 0:4.8.5-16.el7   glibc-devel.x86_64 0:2.17-196.el7   glibc-headers.x86_64 0:2.17-196.el7   kernel-headers.x86_64 0:3.10.0-693.2.2.el7   libmpc.x86_64 0:1.0.1-3.el7   mpfr.x86_64 0:3.1.1-4.el7  </span><br><span class="line"></span><br><span class="line">Dependency Updated:</span><br><span class="line">  glibc.x86_64 0:2.17-196.el7                      glibc-common.x86_64 0:2.17-196.el7                      libgcc.x86_64 0:4.8.5-16.el7                      libgomp.x86_64 0:4.8.5-16.el7                     </span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure>
<p>yum install zlib zlib-devel</p>
<p>yum install openssl openssl-devel</p>
<p>vim Modules/Setup.dist<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"># Andrew Kuchling&apos;s zlib module.</span><br><span class="line"># This require zlib 1.1.3 (or later).</span><br><span class="line"># See http://www.gzip.org/zlib/</span><br><span class="line">zlib zlibmodule.c -I$(prefix)/include -L$(exec_prefix)/lib -lz</span><br><span class="line"></span><br><span class="line"># Interface to the Expat XML parser</span><br><span class="line">#</span><br><span class="line"># Expat was written by James Clark and is now maintained by a group of</span><br></pre></td></tr></table></figure></p>
<p> ./configure </p>
<p>make &amp;&amp; make install</p>
<p>ln -s /[path]/python3 python3</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/安装python3/" data-id="cjjedmhbn00750gtjrzftvfg6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python/计算一个目录页下所有文件夹的大小" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/计算一个目录页下所有文件夹的大小/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/计算一个目录页下所有文件夹的大小/">计算一个目录页下所有文件夹的大小</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>`</code><br>import os</p>
<p>homedir = ‘C:\Users’</p>
<p>def get_size(filedir):<br>    tree = os.walk(filedir, topdown=True)<br>    dirsize = 0<br>    for i in tree:<br>        nodeName = i[0]<br>        nodeDirs = i[1]<br>        nodeFiles = i[2]<br>        if(‘Zeal’ in nodeName):<br>            continue<br>        for file in nodeFiles:<br>            dirsize = dirsize + os.path.getsize(nodeName+’\‘+file)<br>    return dirsize</p>
<p>tree = os.walk(homedir, topdown=True)<br>for a,b,c in tree:<br>    for d in b:<br>        pass<br>        print(d,’ : ‘,get_size(a+’\‘+d)/1024/1024)<br>    break</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/计算一个目录页下所有文件夹的大小/" data-id="cjjedmhbo00770gtjrn8x32m7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python/音频处理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/音频处理/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/音频处理/">音频处理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>网页录音<br><a href="https://github.com/mattdiamond/Recorderjs" target="_blank" rel="noopener">https://github.com/mattdiamond/Recorderjs</a></p>
<p>格式转换，切割合并<br><a href="https://github.com/jiaaro/pydub#installation" target="_blank" rel="noopener">https://github.com/jiaaro/pydub#installation</a></p>
<p>音频分析<br><a href="https://docs.python.org/3/library/wave.html" target="_blank" rel="noopener">https://docs.python.org/3/library/wave.html</a><br><a href="http://bigsec.net/b52/scipydoc/wave_pyaudio.html" target="_blank" rel="noopener">http://bigsec.net/b52/scipydoc/wave_pyaudio.html</a></p>
<p><code>`</code><br>import wave<br>from matplotlib import pylab as pl<br>import numpy as np<br>import pydub<br>from pydub import AudioSegment</p>
<p>pydub.AudioSegment.converter = r’ffmpeg.exe’<br>sound = AudioSegment.from_mp3(r”2018-05-09T09_40_04.301Z.mp3”)<br>sound.export(“test.wav”, format=”wav”)</p>
<h1 id="打开WAV文档"><a href="#打开WAV文档" class="headerlink" title="打开WAV文档"></a>打开WAV文档</h1><p>f = wave.open(r”test.wav”, “rb”)</p>
<h1 id="读取格式信息"><a href="#读取格式信息" class="headerlink" title="读取格式信息"></a>读取格式信息</h1><h1 id="nchannels-sampwidth-framerate-nframes-comptype-compname"><a href="#nchannels-sampwidth-framerate-nframes-comptype-compname" class="headerlink" title="(nchannels, sampwidth, framerate, nframes, comptype, compname)"></a>(nchannels, sampwidth, framerate, nframes, comptype, compname)</h1><p>params = f.getparams()<br>nchannels, sampwidth, framerate, nframes = params[:4]</p>
<h1 id="读取波形数据"><a href="#读取波形数据" class="headerlink" title="读取波形数据"></a>读取波形数据</h1><p>str_data = f.readframes(nframes)<br>f.close()</p>
<p>#将波形数据转换为数组<br>wave_data = np.fromstring(str_data, dtype=np.short)<br>wave_data.shape = -1, 2<br>wave_data = wave_data.T</p>
<h1 id="wave-data-wave-data-1"><a href="#wave-data-wave-data-1" class="headerlink" title="wave_data = wave_data[1]"></a>wave_data = wave_data[1]</h1><p>time = np.arange(0, nframes) * (1.0 / framerate)</p>
<h1 id="绘制波形"><a href="#绘制波形" class="headerlink" title="绘制波形"></a>绘制波形</h1><p>pl.subplot(211)<br>pl.plot(time, wave_data[0])<br>pl.subplot(212)<br>pl.plot(time, wave_data[1], c=”g”)<br>pl.xlabel(“time (seconds)”)<br>pl.show()</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/音频处理/" data-id="cjjedmhbp00790gtj68dbj2wa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python/执行某一目录下的所有shell脚本" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/python/执行某一目录下的所有shell脚本/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/python/执行某一目录下的所有shell脚本/">执行某一目录下的所有shell脚本</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="for-i-in-tree-会多次循环，很奇怪"><a href="#for-i-in-tree-会多次循环，很奇怪" class="headerlink" title="for i in tree:会多次循环，很奇怪"></a>for i in tree:会多次循环，很奇怪</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line"></span><br><span class="line"># import commands</span><br><span class="line"></span><br><span class="line">homedir = os.path.dirname(os.path.abspath(&apos;run_sqoop.py&apos;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_shells(filedir):</span><br><span class="line">    print(&quot;dirName............. &quot;, filedir)</span><br><span class="line">    tree = os.walk(filedir, topdown=True)</span><br><span class="line">    for i in tree:</span><br><span class="line">        nodeName = i[0]</span><br><span class="line">        nodeDir = i[1]</span><br><span class="line">        nodeFiles = i[2]</span><br><span class="line">        print(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;nodeName: &quot;, nodeName)</span><br><span class="line">        for file in nodeFiles:</span><br><span class="line">            if (file.endswith(&quot;.sh&quot;)):</span><br><span class="line">                command = nodeName + &quot;/&quot; + file</span><br><span class="line">                print(&quot;commands:&quot;, command)</span><br><span class="line">                # out = commands.getstatusoutput(command)</span><br><span class="line">                # print(out)</span><br><span class="line">        for shelldir in nodeDir:</span><br><span class="line">            get_shells(shelldir)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_shells(homedir)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/python/执行某一目录下的所有shell脚本/" data-id="cjjedmhbq007b0gtjk976z3yi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spark/10.RDD基本操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/spark/10.RDD基本操作/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/spark/10.RDD基本操作/">10.RDD基本操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">package rddbasic</span><br><span class="line"></span><br><span class="line">import org.apache.spark.storage.StorageLevel</span><br><span class="line">import org.apache.spark.&#123;SparkConf, SparkContext&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">  * Created by hanq0 on 2017/10/23.</span><br><span class="line">  */</span><br><span class="line">object stuRdds &#123;</span><br><span class="line">  val conf = new SparkConf().setAppName(&quot;WordCount&quot;).setMaster(&quot;local&quot;)</span><br><span class="line">  val sc = new SparkContext(conf)</span><br><span class="line"></span><br><span class="line">  //内部集合</span><br><span class="line">  def innnerRdds(): Unit = &#123;</span><br><span class="line">    val data = Array(1, 2, 3, 4, 5)</span><br><span class="line">    val distData = sc.parallelize(data)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //外部数据</span><br><span class="line">  def outterRdds(): Unit = &#123;</span><br><span class="line">    val distFile = sc.textFile(&quot;data.txt&quot;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //基本操作</span><br><span class="line">  def basicRdd(): Unit = &#123;</span><br><span class="line">    val lines = sc.textFile(&quot;data.txt&quot;)</span><br><span class="line">    val lineLengths = lines.map(s =&gt; s.length)</span><br><span class="line">    val totalLength = lineLengths.reduce((a, b) =&gt; a + b)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //调用函数</span><br><span class="line">  def passFunctions(): Unit = &#123;</span><br><span class="line">    val lines = sc.textFile(&quot;data.txt&quot;)</span><br><span class="line">    val lineLengths = lines.map(MyFunctions.mymap)</span><br><span class="line">    //val totalLength = lineLengths.reduce(MyFunctions.myreduce())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //闭包，集群模式下变量被分隔</span><br><span class="line">  def valuesDisparched(): Unit = &#123;</span><br><span class="line">    var counter = 0</span><br><span class="line">    val data = Array(1, 2, 3, 4, 5)</span><br><span class="line">    var rdd = sc.parallelize(data)</span><br><span class="line">    // Wrong: Don&apos;t do this!!</span><br><span class="line">    rdd.foreach(x =&gt; counter += x)</span><br><span class="line">    println(&quot;Counter value: &quot; + counter)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //对键值对（key-value）的操作</span><br><span class="line">  def KeyValueactions(): Unit = &#123;</span><br><span class="line">    val lines = sc.textFile(&quot;data.txt&quot;)</span><br><span class="line">    val pairs = lines.map(s =&gt; (s, 1))</span><br><span class="line">    val counts = pairs.reduceByKey((a, b) =&gt; a + b)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //Rdd的转换Transformations</span><br><span class="line">  def RddTransformations(): Unit = &#123;</span><br><span class="line">    val data0 = Array(1, 2, 3, 4, 5)</span><br><span class="line">    val data1 = Array(6, 7, 8, 9, 0)</span><br><span class="line">    val data2 = data0.union(data1)</span><br><span class="line">    //sortByKey([ascending], [numTasks]),sample(withReplacement, fraction, seed),repartition(numPartitions)......</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //Rdd的操作Actions</span><br><span class="line">  def RddActions(): Unit = &#123;</span><br><span class="line">    val data = Array(1, 2, 3, 4, 5)</span><br><span class="line">    var rdd = sc.parallelize(data)</span><br><span class="line">    rdd.foreach(x =&gt; x+1)</span><br><span class="line">    //reduce(func),collect(),count()......</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //Rdd的持久化</span><br><span class="line">  def RddStorage(): Unit = &#123;</span><br><span class="line">    val data = sc.textFile(&quot;data.txt&quot;)</span><br><span class="line">    data.persist(StorageLevel.MEMORY_ONLY) // persist() 方法进行设置</span><br><span class="line">    data.cache() //cache() 方法是使用默认存储级别的快捷设置方法</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //共享变量</span><br><span class="line"></span><br><span class="line">  //Broadcast variables（广播变量）允许程序员将一个 read-only（只读的）变量缓存到每台机器上</span><br><span class="line">  def BroadcastVariables(): Unit = &#123;</span><br><span class="line">    val broadcastVar = sc.broadcast(Array(1, 2, 3))</span><br><span class="line">    print(broadcastVar.value)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //Accumulators（累加器）是一个仅可以执行 “added”（添加）的变量来通过一个关联和交换操作</span><br><span class="line">  def AccumulatorsVariables(): Unit = &#123;</span><br><span class="line">    val accum = sc.longAccumulator(&quot;My Accumulator&quot;)</span><br><span class="line">    sc.parallelize(Array(1, 2, 3, 4)).foreach(x =&gt; accum.add(x))</span><br><span class="line">    print(accum.value)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/spark/10.RDD基本操作/" data-id="cjjedmhbr007d0gtj7xczoaep" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/spark/">spark</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spark/1.spark windows编译" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/spark/1.spark windows编译/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/spark/1.spark windows编译/">1.spark windows编译</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="1-环境"><a href="#1-环境" class="headerlink" title="1.环境"></a>1.环境</h4><p>jdk1.8</p>
<p>scala2.11.8</p>
<p>spark2.11</p>
<p>maven4.0</p>
<h4 id="2-github客户端"><a href="#2-github客户端" class="headerlink" title="2.github客户端"></a>2.github客户端</h4><p>官方给出的命令是在Linux上的</p>
<blockquote>
<p>./build/mvn -DskipTests clean package</p>
</blockquote>
<p>调用shell脚本取只想一些命令然后在用maven编译,一些过程如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">install_app() &#123;</span><br><span class="line">  local remote_tarball=&quot;$1/$2&quot;</span><br><span class="line">  local local_tarball=&quot;$&#123;_DIR&#125;/$2&quot;</span><br><span class="line">  local binary=&quot;$&#123;_DIR&#125;/$3&quot;</span><br><span class="line"></span><br><span class="line">  # setup `curl` and `wget` silent options if we&apos;re running on Jenkins</span><br><span class="line">  local curl_opts=&quot;-L&quot;</span><br><span class="line">  local wget_opts=&quot;&quot;</span><br><span class="line">  if [ -n &quot;$AMPLAB_JENKINS&quot; ]; then</span><br><span class="line">    curl_opts=&quot;-s $&#123;curl_opts&#125;&quot;</span><br><span class="line">    wget_opts=&quot;--quiet $&#123;wget_opts&#125;&quot;</span><br><span class="line">  else</span><br><span class="line">    curl_opts=&quot;--progress-bar $&#123;curl_opts&#125;&quot;</span><br><span class="line">    wget_opts=&quot;--progress=bar:force $&#123;wget_opts&#125;&quot;</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  if [ -z &quot;$3&quot; -o ! -f &quot;$binary&quot; ]; then</span><br><span class="line">    # check if we already have the tarball</span><br><span class="line">    # check if we have curl installed</span><br><span class="line">    # download application</span><br><span class="line">    [ ! -f &quot;$&#123;local_tarball&#125;&quot; ] &amp;&amp; [ $(command -v curl) ] &amp;&amp; \</span><br><span class="line">      echo &quot;exec: curl $&#123;curl_opts&#125; $&#123;remote_tarball&#125;&quot; 1&gt;&amp;2 &amp;&amp; \</span><br><span class="line">      curl $&#123;curl_opts&#125; &quot;$&#123;remote_tarball&#125;&quot; &gt; &quot;$&#123;local_tarball&#125;&quot;</span><br><span class="line">    # if the file still doesn&apos;t exist, lets try `wget` and cross our fingers</span><br><span class="line">    [ ! -f &quot;$&#123;local_tarball&#125;&quot; ] &amp;&amp; [ $(command -v wget) ] &amp;&amp; \</span><br><span class="line">      echo &quot;exec: wget $&#123;wget_opts&#125; $&#123;remote_tarball&#125;&quot; 1&gt;&amp;2 &amp;&amp; \</span><br><span class="line">      wget $&#123;wget_opts&#125; -O &quot;$&#123;local_tarball&#125;&quot; &quot;$&#123;remote_tarball&#125;&quot;</span><br><span class="line">    # if both were unsuccessful, exit</span><br><span class="line">    [ ! -f &quot;$&#123;local_tarball&#125;&quot; ] &amp;&amp; \</span><br><span class="line">      echo -n &quot;ERROR: Cannot download $2 with cURL or wget; &quot; &amp;&amp; \</span><br><span class="line">      echo &quot;please install manually and try again.&quot; &amp;&amp; \</span><br><span class="line">      exit 2</span><br><span class="line">........</span><br></pre></td></tr></table></figure></p>
<p>需要用github的gitbush调用shell脚本</p>
<p>github客户端安装</p>
<p>鼠标右键会出现打开gitbush。。。</p>
<h4 id="3-编译"><a href="#3-编译" class="headerlink" title="3.编译"></a>3.编译</h4><p>在项目根目录下右键打开gitbush<br>输入命令</p>
<blockquote>
<p>./build/mvn -DskipTests clean package</p>
</blockquote>
<p>如果在有maven的报错可能是maven配置问题，但是shell脚本执行的操作已经完成</p>
<p>直接在根目录下maven打包就可以了</p>
<blockquote>
<p>mvn install</p>
</blockquote>
<p>编译时间很长</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/spark/1.spark windows编译/" data-id="cjjedmhbs007f0gtjxfpprrvt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/spark/">spark</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spark/2.windows配置spark运行环境" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/spark/2.windows配置spark运行环境/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/spark/2.windows配置spark运行环境/">2.windows配置spark运行环境</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://blog.csdn.net/u011513853/article/details/52865076" target="_blank" rel="noopener">windows环境安装</a></p>
<h4 id="1-java配置"><a href="#1-java配置" class="headerlink" title="1.java配置"></a>1.java配置</h4><p>使用jdk1.8<br>配置略</p>
<h4 id="2-下载、配置scala"><a href="#2-下载、配置scala" class="headerlink" title="2.下载、配置scala"></a>2.下载、配置scala</h4><p><a href="http://www.scala-lang.org/" target="_blank" rel="noopener">官网</a>下载scala，解压放到自己的目录下。==目录不要有空格==</p>
<p>把Scala的bin文件夹所在目录配置到环境变量的path中（过程和jdk配置一样）</p>
<h5 id="测试是有完成"><a href="#测试是有完成" class="headerlink" title="测试是有完成"></a>测试是有完成</h5><p>win+R cmd：</p>
<pre><code>scala
</code></pre><p>出现scala配置就是安装好了</p>
<h4 id="3-下载、配置spark"><a href="#3-下载、配置spark" class="headerlink" title="3.下载、配置spark"></a>3.下载、配置spark</h4><p><a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">官网</a>下载sapark，版本要和scala对应。 ==官网会有显示==</p>
<p>解压到自己的目录下然后配置环境变量的path</p>
<h5 id="测试安装"><a href="#测试安装" class="headerlink" title="测试安装"></a>测试安装</h5><p>cmd:</p>
<pre><code>spark-shell
</code></pre><p>出现：</p>
<pre><code>Spark context available as sc.
SQL context available as sqlContext
</code></pre><p>安装成功</p>
<h4 id="4-下载、配置hadoop"><a href="#4-下载、配置hadoop" class="headerlink" title="4.下载、配置hadoop"></a>4.下载、配置hadoop</h4><p>参考其他</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/spark/2.windows配置spark运行环境/" data-id="cjjedmhbt007i0gtjogvhm688" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/spark/">spark</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spark/4.scala、maven、spark下的wordcount程序" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/07/10/spark/4.scala、maven、spark下的wordcount程序/" class="article-date">
  <time datetime="2018-07-10T13:09:19.000Z" itemprop="datePublished">2018-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2018/07/10/spark/4.scala、maven、spark下的wordcount程序/">4.scala、maven、spark下的wordcount程序</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><p>jdk1.8</p>
<p>scala2.11.8</p>
<p>spark2.11</p>
<p>maven4.0</p>
<h4 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h4><p>ide:idea</p>
<p>新建一个maven工程，添加jdk和scala支持</p>
<p>然后添加maven依赖</p>
<p>编写wordcount代码</p>
<p>右键运行scala类</p>
<h4 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖:"></a>maven依赖:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;test&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;test&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.scala-lang&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;scala-library&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.11.8&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.scala-lang&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;scala-compiler&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.11.8&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spark-core_2.11&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.3.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spark-sql_2.11&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.3.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<h4 id="wordcout代码"><a href="#wordcout代码" class="headerlink" title="wordcout代码:"></a>wordcout代码:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">package com.spark.app</span><br><span class="line"></span><br><span class="line">import org.apache.spark.&#123;SparkContext, SparkConf&#125;</span><br><span class="line"></span><br><span class="line">object WordCount &#123;</span><br><span class="line">  def main(args: Array[String]) &#123;</span><br><span class="line">    /**</span><br><span class="line">      * 第1步；创建Spark的配置对象SparkConf，设置Spark程序运行时的配置信息</span><br><span class="line">      * 例如 setAppName用来设置应用程序的名称，在程序运行的监控界面可以看到该名称，</span><br><span class="line">      * setMaster设置程序运行在本地还是运行在集群中，运行在本地可是使用local参数，也可以使用local[K]/local[*],</span><br><span class="line">      * 可以去spark官网查看它们不同的意义。 如果要运行在集群中，以Standalone模式运行的话，需要使用spark://HOST:PORT</span><br><span class="line">      * 的形式指定master的IP和端口号，默认是7077</span><br><span class="line">      */</span><br><span class="line">    val conf = new SparkConf().setAppName(&quot;WordCount&quot;).setMaster(&quot;local&quot;)</span><br><span class="line">    //  val conf = new SparkConf().setAppName(&quot;WordCount&quot;).setMaster(&quot;spark://master:7077&quot;)  // 运行在集群中</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">      * 第2步：创建SparkContext 对象</span><br><span class="line">      * SparkContext是Spark程序所有功能的唯一入口</span><br><span class="line">      * SparkContext核心作用： 初始化Spark应用程序运行所需要的核心组件，包括DAGScheduler、TaskScheduler、SchedulerBackend</span><br><span class="line">      * 同时还会负责Spark程序往Master注册程序</span><br><span class="line">      *</span><br><span class="line">      * 通过传入SparkConf实例来定制Spark运行的具体参数和配置信息</span><br><span class="line">      */</span><br><span class="line">    val sc = new SparkContext(conf)</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">      * 第3步： 根据具体的数据来源(HDFS、 HBase、Local FS、DB、 S3等)通过SparkContext来创建RDD</span><br><span class="line">      * RDD 的创建基本有三种方式： 根据外部的数据来源(例如HDFS)、根据Scala集合使用SparkContext的parallelize方法、</span><br><span class="line">      * 由其他的RDD操作产生</span><br><span class="line">      * 数据会被RDD划分成为一系列的Partitions，分配到每个Partition的数据属于一个Task的处理范畴</span><br><span class="line">      */</span><br><span class="line"></span><br><span class="line">    val lines = sc.textFile(&quot;D:/resources/README.md&quot;)   // 读取本地文件</span><br><span class="line">    //  val lines = sc.textFile(&quot;/library/wordcount/input&quot;)   // 读取HDFS文件，并切分成不同的Partition</span><br><span class="line">    //  val lines = sc.textFile(&quot;hdfs://master:9000/libarary/wordcount/input&quot;)  // 或者明确指明是从HDFS上获取数据</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">      * 第4步： 对初始的RDD进行Transformation级别的处理，例如 map、filter等高阶函数来进行具体的数据计算</span><br><span class="line">      */</span><br><span class="line">    val words = lines.flatMap(_.split(&quot; &quot;)).filter(word =&gt; word != &quot; &quot;)  // 拆分单词，并过滤掉空格，当然还可以继续进行过滤，如去掉标点符号</span><br><span class="line"></span><br><span class="line">    val pairs = words.map(word =&gt; (word, 1))  // 在单词拆分的基础上对每个单词实例计数为1, 也就是 word =&gt; (word, 1)</span><br><span class="line"></span><br><span class="line">    val wordscount = pairs.reduceByKey(_ + _)  // 在每个单词实例计数为1的基础之上统计每个单词在文件中出现的总次数, 即key相同的value相加</span><br><span class="line">    //  val wordscount = pairs.reduceByKey((v1, v2) =&gt; v1 + v2)  // 等同于</span><br><span class="line"></span><br><span class="line">    wordscount.collect.foreach(println)  // 打印结果，使用collect会将集群中的数据收集到当前运行drive的机器上，需要保证单台机器能放得下所有数据</span><br><span class="line"></span><br><span class="line">    sc.stop()   // 释放资源</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="result"><a href="#result" class="headerlink" title="result"></a>result</h4>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  17/10/09 16:25:59 INFO SparkUI: Stopped Spark web UI at http://WINDOWS-0EQCJPQ.hs.handsome.com.cn:4040</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">(hello,14)</span><br><span class="line">(h1,14)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">17/10/09 16:25:59 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!</span><br><span class="line">17/10/09 16:25:59 INFO MemoryStore: MemoryStore cleared</span><br><span class="line">17/10/09 16:25:59 INFO BlockManager: BlockManager stopped</span><br><span class="line">17/10/09 16:25:59 INFO BlockManagerMaster: BlockManagerMaster stopped</span><br><span class="line">17/10/09 16:25:59 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span><br><span class="line">17/10/09 16:25:59 INFO SparkContext: Successfully stopped SparkContext</span><br><span class="line">17/10/09 16:25:59 INFO ShutdownHookManager: Shutdown hook called</span><br><span class="line">17/10/09 16:25:59 INFO ShutdownHookManager: Deleting directory C:\Users\hanqian18790\AppData\Local\Temp\spark-14748c73-2d1d-46b1-82de-5c1328f7fabe</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hanlaotwo.com/2018/07/10/spark/4.scala、maven、spark下的wordcount程序/" data-id="cjjedmhbu007k0gtjbc2hhmyz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/spark/">spark</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/blog/page/12/">&laquo; Prev</a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/11/">11</a><a class="page-number" href="/blog/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/blog/page/14/">14</a><a class="page-number" href="/blog/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/18/">18</a><a class="extend next" rel="next" href="/blog/page/14/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Hadoop/">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Jstrom/">Jstrom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/note/">note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/oracle/">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/scala/">scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/spark/">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/work/">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/其他/">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/开发工具/">开发工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/项目/">项目</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/Hadoop/" style="font-size: 17.5px;">Hadoop</a> <a href="/blog/tags/Java/" style="font-size: 16.67px;">Java</a> <a href="/blog/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/blog/tags/Jstrom/" style="font-size: 12.5px;">Jstrom</a> <a href="/blog/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/blog/tags/kafka/" style="font-size: 12.5px;">kafka</a> <a href="/blog/tags/mysql/" style="font-size: 14.17px;">mysql</a> <a href="/blog/tags/note/" style="font-size: 18.33px;">note</a> <a href="/blog/tags/oracle/" style="font-size: 13.33px;">oracle</a> <a href="/blog/tags/python/" style="font-size: 19.17px;">python</a> <a href="/blog/tags/redis/" style="font-size: 15px;">redis</a> <a href="/blog/tags/scala/" style="font-size: 10px;">scala</a> <a href="/blog/tags/spark/" style="font-size: 15.83px;">spark</a> <a href="/blog/tags/web/" style="font-size: 10.83px;">web</a> <a href="/blog/tags/work/" style="font-size: 10px;">work</a> <a href="/blog/tags/其他/" style="font-size: 10px;">其他</a> <a href="/blog/tags/开发工具/" style="font-size: 15px;">开发工具</a> <a href="/blog/tags/数据库/" style="font-size: 12.5px;">数据库</a> <a href="/blog/tags/项目/" style="font-size: 11.67px;">项目</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/06/">六月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2018/07/10/数据库/redis/redis增删改查----Spring+redis/">redis增删改查----Spring+redis</a>
          </li>
        
          <li>
            <a href="/blog/2018/07/10/数据库/redis/资料/">资料</a>
          </li>
        
          <li>
            <a href="/blog/2018/07/10/数据库/redis/redis增删改查----控制台/">redis增删改查----控制台</a>
          </li>
        
          <li>
            <a href="/blog/2018/07/10/数据库/redis/springLTredis/">springLTredis</a>
          </li>
        
          <li>
            <a href="/blog/2018/07/10/数据库/redis/redis配置/">redis配置</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Han Laotwo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>



  </div>
</body>
</html>